<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fruit Mart</title>
  </head>
  <body>
    <h1>Fruit Mart</h1>
    <input type="text" id="query" />
    <div style="display: flex; flex-direction: row;">
      <div style="padding: 30px;">
        <h3>
          Vanilla Suggestions
          <span id="vanillaJSFilterCount"></span>
        </h3>
        <ul id="vanillaSuggestions"></ul>
      </div>
      <div style="padding: 30px;">
        <h3>
          RxJS Suggestions
          <span id="rxJSFilterCount"></span>
        </h3>
        <ul id="rxjsSuggestions"></ul>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/rxjs/6.6.0/rxjs.umd.min.js"></script>
    <script>
      const fruits = JSON.parse(
        '["Abiu","Açaí","Acerola","Ackee","African cucumber","Apple","Apricot","Avocado","Banana","Bilberry","Blackberry","Blackcurrant","Black sapote","Blueberry","Boysenberry","Breadfruit","Buddha\'s hand (fingered citron)","Cactus pear","Canistel","Cempedak","Cherimoya (Custard Apple)","Cherry","Chico fruit","Cloudberry","Coco De Mer","Coconut","Crab apple","Cranberry","Currant","Damson","Date","Dragonfruit (or Pitaya)","Durian","Egg Fruit","Elderberry","Feijoa","Fig","Finger Lime (or Caviar Lime)","Goji berry","Gooseberry","Grape","Raisin","Grapefruit","Grewia asiatica (phalsa or falsa)","Guava","Hala Fruit","Honeyberry","Huckleberry","Jabuticaba","Jackfruit","Jambul","Japanese plum","Jostaberry","Jujube","Juniper berry","Kaffir Lime","Kiwano (horned melon)","Kiwifruit","Kumquat","Lemon","Lime","Loganberry","Longan","Loquat","Lulo","Lychee","Magellan Barberry","Mamey Apple","Mamey Sapote","Mango","Mangosteen","Marionberry","Melon","Cantaloupe","Galia melon","Honeydew","Mouse melon","Musk melon","Watermelon","Miracle fruit","Monstera deliciosa","Mulberry","Nance","Nectarine","Orange","Blood orange","Clementine","Mandarine","Tangerine","Papaya","Passionfruit","Peach","Pear","Persimmon","Plantain","Plum","Prune (dried plum)","Pineapple","Pineberry","Plumcot (or Pluot)","Pomegranate","Pomelo","Purple mangosteen","Quince","Raspberry","Salmonberry","Rambutan (or Mamin Chino)","Redcurrant","Rose apple","Salal berry","Salak","Satsuma","Shine Muscat or Vitis Vinifera","Sloe or Hawthorn Berry","Soursop","Star apple","Star fruit","Strawberry","Surinam cherry","Tamarillo","Tamarind","Tangelo","Tayberry","Tomato","Ugli fruit","White currant","White sapote","Yuzu","Bell pepper","Chile pepper","Corn kernel","Cucumber","Eggplant","Jalapeño","Olive","Pea","Pumpkin","Squash","Tomato","Zucchini"]',
      )
      // Refers to the query box from the search query is to be fetched.
      const queryBox = document.getElementById('query')
      // Refers to the list of suggestions generated by VanillaJS
      const vanillaSuggestions = document.getElementById('vanillaSuggestions')
      // Refers to the list of suggestions generated by RxJS
      const rxjsSuggestions = document.getElementById('rxjsSuggestions')

      // Refers to the display unit which displays
      // the number of time the filter function got called.
      const rxjsFilterCountBox = document.getElementById('rxJSFilterCount')
      const vanillaJSFilterCountBox = document.getElementById(
        'vanillaJSFilterCount',
      )

      // Count of How many times the filter function gets called
      // in the VanillaJS
      let vanillaJSFilterCount = 0
      // Count of How many times the filter function gets called
      // in the RxJS Script
      let rxJSFilterCount = 0

      // Using Vanilla JS
      queryBox.addEventListener('input', () => {
        ++vanillaJSFilterCount
        const suggestedFruits = fruits.filter((f) =>
          f.startsWith(queryBox.value),
        )
        vanillaSuggestions.innerHTML = ''
        suggestedFruits.forEach((fruit) => {
          const fruitEl = document.createElement('li')
          fruitEl.innerText = fruit
          vanillaSuggestions.appendChild(fruitEl)
        })
        vanillaJSFilterCountBox.innerText = vanillaJSFilterCount
      })

      // Using RxJS code here...
      const inputEvent = rxjs.fromEvent(queryBox, 'keyup')
      const delayedResults = inputEvent.pipe(rxjs.operators.debounceTime(400))
      delayedResults.subscribe(() => {
        ++rxJSFilterCount
        const suggestedFruits = fruits.filter((f) =>
          f.startsWith(queryBox.value),
        )
        rxjsSuggestions.innerHTML = ''
        suggestedFruits.forEach((fruit) => {
          const fruitEl = document.createElement('li')
          fruitEl.innerText = fruit
          rxjsSuggestions.appendChild(fruitEl)
        })
        rxjsFilterCountBox.innerText = rxJSFilterCount
      })
    </script>
  </body>
</html>

<!-- debounceTime(1000), -->
